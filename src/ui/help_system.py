#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
å¸®åŠ©ç³»ç»Ÿ
æä¾›åœ¨çº¿å¸®åŠ©ã€æ“ä½œæ¼”ç¤ºå’Œç”¨æˆ·æ‰‹å†ŒåŠŸèƒ½
"""

import sys
import os
from pathlib import Path
from typing import Dict, List, Optional

from PyQt5.QtWidgets import (
    QDialog, QVBoxLayout, QHBoxLayout, QGridLayout,
    QLabel, QPushButton, QTextEdit, QTabWidget,
    QWidget, QTreeWidget, QTreeWidgetItem, QSplitter,
    QScrollArea, QGroupBox, QFrame, QDialogButtonBox,
    QListWidget, QListWidgetItem, QProgressBar
)
from PyQt5.QtCore import Qt, QTimer, pyqtSignal, QThread
from PyQt5.QtGui import QFont, QPixmap, QIcon, QTextDocument

# æ·»åŠ srcç›®å½•åˆ°Pythonè·¯å¾„
sys.path.insert(0, str(Path(__file__).parent.parent))

from core.logger import get_logger
from core.config_manager import ConfigManager


class HelpContentLoader(QThread):
    """å¸®åŠ©å†…å®¹åŠ è½½å™¨"""
    
    content_loaded = pyqtSignal(str, str)  # topic, content
    loading_progress = pyqtSignal(int, str)
    
    def __init__(self, topic: str):
        super().__init__()
        self.topic = topic
        self.logger = get_logger("help_content_loader")
    
    def run(self):
        """åŠ è½½å¸®åŠ©å†…å®¹"""
        try:
            self.loading_progress.emit(20, "æ­£åœ¨åŠ è½½å¸®åŠ©å†…å®¹...")
            self.msleep(200)
            
            content = self.load_help_content(self.topic)
            
            self.loading_progress.emit(100, "åŠ è½½å®Œæˆ")
            self.content_loaded.emit(self.topic, content)
            
        except Exception as e:
            self.logger.error(f"åŠ è½½å¸®åŠ©å†…å®¹å¤±è´¥: {e}")
            self.content_loaded.emit(self.topic, f"åŠ è½½å¤±è´¥: {e}")
    
    def load_help_content(self, topic: str) -> str:
        """åŠ è½½æŒ‡å®šä¸»é¢˜çš„å¸®åŠ©å†…å®¹"""
        help_contents = {
            "å¿«é€Ÿå…¥é—¨": """
# å¿«é€Ÿå…¥é—¨æŒ‡å—

## æ¬¢è¿ä½¿ç”¨è®¾å¤‡æŒ‡çº¹è¯†åˆ«ä¸ä¿®æ”¹å·¥å…·

æœ¬å·¥å…·æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ•™å­¦å’Œç ”ç©¶å¹³å°ï¼Œæ—¨åœ¨å¸®åŠ©ç”¨æˆ·ç†è§£è®¾å¤‡æŒ‡çº¹è¯†åˆ«æŠ€æœ¯çš„åŸç†å’Œå®ç°æ–¹å¼ã€‚

### ä¸»è¦åŠŸèƒ½

1. **ç³»ç»ŸçŠ¶æ€ç›‘æ§**
   - å®æ—¶æ˜¾ç¤ºç³»ç»Ÿä¿¡æ¯å’Œæ€§èƒ½æ•°æ®
   - ç›‘æ§æƒé™çŠ¶æ€å’Œå®‰å…¨è®¾ç½®
   - æä¾›ç³»ç»Ÿå¥åº·çŠ¶å†µè¯„ä¼°

2. **è®¾å¤‡æŒ‡çº¹ç®¡ç†**
   - æŸ¥çœ‹å’Œç®¡ç†ç½‘ç»œé€‚é…å™¨ä¿¡æ¯
   - ä¿®æ”¹MACåœ°å€ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰
   - ç®¡ç†æœºå™¨GUIDå’Œç¡¬ä»¶æ ‡è¯†

3. **å¤‡ä»½ç®¡ç†**
   - åˆ›å»ºç³»ç»Ÿé…ç½®å¤‡ä»½
   - ç®¡ç†å¤‡ä»½å†å²è®°å½•
   - å¿«é€Ÿæ¢å¤ç³»ç»Ÿè®¾ç½®

4. **æ•™è‚²åŠŸèƒ½**
   - è¯¦ç»†çš„æŠ€æœ¯åŸç†è§£é‡Š
   - åˆ†æ­¥éª¤çš„æ“ä½œæŒ‡å¯¼
   - ä¸°å¯Œçš„å­¦ä¹ èµ„æºå’Œå‚è€ƒèµ„æ–™

### é¦–æ¬¡ä½¿ç”¨

1. **æ£€æŸ¥æƒé™**ï¼šç¡®ä¿ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œç¨‹åº
2. **åˆ›å»ºå¤‡ä»½**ï¼šåœ¨è¿›è¡Œä»»ä½•ä¿®æ”¹å‰å…ˆåˆ›å»ºç³»ç»Ÿå¤‡ä»½
3. **äº†è§£é£é™©**ï¼šä»”ç»†é˜…è¯»æ¯ä¸ªåŠŸèƒ½çš„é£é™©è¯´æ˜
4. **å­¦ä¹ åŸç†**ï¼šé€šè¿‡æ•™è‚²åŠŸèƒ½äº†è§£ç›¸å…³æŠ€æœ¯åŸç†

### å®‰å…¨æé†’

âš ï¸ **é‡è¦æé†’**ï¼š
- æœ¬å·¥å…·ä»…ç”¨äºæ•™å­¦å’Œç ”ç©¶ç›®çš„
- è¯·åœ¨æˆæƒçš„ç¯å¢ƒä¸­ä½¿ç”¨
- éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„å’Œç½‘ç»œä½¿ç”¨æ”¿ç­–
- ä¸å¾—ç”¨äºéæ³•ç½‘ç»œæ´»åŠ¨

### è·å–å¸®åŠ©

å¦‚æœæ‚¨åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥ï¼š
- æŸ¥çœ‹æœ¬å¸®åŠ©ç³»ç»Ÿçš„è¯¦ç»†è¯´æ˜
- å‚è€ƒæ•™è‚²åŠŸèƒ½ä¸­çš„æ“ä½œæŒ‡å¯¼
- æŸ¥çœ‹æ—¥å¿—ä¿¡æ¯äº†è§£é”™è¯¯è¯¦æƒ…
            """,
            
            "MACåœ°å€ä¿®æ”¹": """
# MACåœ°å€ä¿®æ”¹æŒ‡å—

## ä»€ä¹ˆæ˜¯MACåœ°å€

MACåœ°å€ï¼ˆMedia Access Control Addressï¼‰æ˜¯ç½‘ç»œè®¾å¤‡çš„ç‰©ç†åœ°å€ï¼Œç”¨äºåœ¨ç½‘ç»œä¸­å”¯ä¸€æ ‡è¯†è®¾å¤‡ã€‚

### MACåœ°å€æ ¼å¼
- æ ‡å‡†æ ¼å¼ï¼šXX:XX:XX:XX:XX:XX
- å…¶ä»–æ ¼å¼ï¼šXX-XX-XX-XX-XX-XXã€XXXXXXXXXXXX

### ä¿®æ”¹æ­¥éª¤

1. **å‡†å¤‡å·¥ä½œ**
   - ç¡®ä¿å…·æœ‰ç®¡ç†å‘˜æƒé™
   - åˆ›å»ºç³»ç»Ÿå¤‡ä»½
   - è®°å½•åŸå§‹MACåœ°å€

2. **é€‰æ‹©é€‚é…å™¨**
   - åœ¨"è®¾å¤‡æŒ‡çº¹"æ ‡ç­¾é¡µä¸­æŸ¥çœ‹ç½‘ç»œé€‚é…å™¨
   - é€‰æ‹©è¦ä¿®æ”¹çš„é€‚é…å™¨
   - ç‚¹å‡»"ä¿®æ”¹"æŒ‰é’®

3. **è¾“å…¥æ–°MACåœ°å€**
   - è¾“å…¥æœ‰æ•ˆçš„MACåœ°å€æ ¼å¼
   - å¯ä»¥ä½¿ç”¨"ç”ŸæˆéšæœºMAC"åŠŸèƒ½
   - ç³»ç»Ÿä¼šè‡ªåŠ¨éªŒè¯æ ¼å¼

4. **ç¡®è®¤ä¿®æ”¹**
   - ä»”ç»†é˜…è¯»é£é™©è­¦å‘Š
   - å®Œæˆä¸‰çº§ç¡®è®¤æµç¨‹
   - ç­‰å¾…ä¿®æ”¹å®Œæˆ

### æ³¨æ„äº‹é¡¹

âš ï¸ **é‡è¦æé†’**ï¼š
- æŸäº›ç½‘å¡ä¸æ”¯æŒMACåœ°å€ä¿®æ”¹
- ä¿®æ”¹åå¯èƒ½éœ€è¦é‡æ–°è¿æ¥ç½‘ç»œ
- ä¼ä¸šç½‘ç»œå¯èƒ½æœ‰MACåœ°å€ç™½åå•
- ä¿®æ”¹å¤±è´¥æ—¶è¯·æ¢å¤åŸå§‹MACåœ°å€

### æ•…éšœæ’é™¤

å¦‚æœä¿®æ”¹å¤±è´¥ï¼š
1. æ£€æŸ¥ç½‘å¡é©±åŠ¨æ˜¯å¦æ”¯æŒMACä¿®æ”¹
2. ç¡®è®¤å…·æœ‰è¶³å¤Ÿçš„ç³»ç»Ÿæƒé™
3. å°è¯•é‡å¯ç½‘ç»œé€‚é…å™¨
4. å¿…è¦æ—¶æ¢å¤åŸå§‹MACåœ°å€
            """,
            
            "æœºå™¨GUIDä¿®æ”¹": """
# æœºå™¨GUIDä¿®æ”¹æŒ‡å—

## âš ï¸ é«˜é£é™©æ“ä½œè­¦å‘Š

æœºå™¨GUIDä¿®æ”¹æ˜¯ä¸€ä¸ªé«˜é£é™©æ“ä½œï¼Œå¯èƒ½å¯¼è‡´ä¸¥é‡åæœã€‚è¯·ä»”ç»†é˜…è¯»æœ¬æŒ‡å—ã€‚

## ä»€ä¹ˆæ˜¯æœºå™¨GUID

æœºå™¨GUIDæ˜¯Windowsç³»ç»Ÿçš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç”¨äºï¼š
- è½¯ä»¶è®¸å¯è¯éªŒè¯
- ç³»ç»Ÿè¯†åˆ«å’Œè·Ÿè¸ª
- åº”ç”¨ç¨‹åºçš„è®¾å¤‡ç»‘å®š

### GUIDæ ¼å¼
æ ‡å‡†æ ¼å¼ï¼šXXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX

### ä¿®æ”¹æ­¥éª¤

1. **é£é™©è¯„ä¼°**
   - äº†è§£æ‰€æœ‰å¯èƒ½çš„é£é™©å’Œåæœ
   - ç¡®ä¿æœ‰å®Œæ•´çš„ç³»ç»Ÿå¤‡ä»½
   - å‡†å¤‡åº”æ€¥æ¢å¤æ–¹æ¡ˆ

2. **åˆ›å»ºå¤‡ä»½**
   - åˆ›å»ºå®Œæ•´çš„ç³»ç»Ÿå¤‡ä»½
   - å¤‡ä»½æ³¨å†Œè¡¨ç›¸å…³é”®å€¼
   - è®°å½•åŸå§‹GUIDå€¼

3. **æ‰§è¡Œä¿®æ”¹**
   - åœ¨"è®¾å¤‡æŒ‡çº¹"æ ‡ç­¾é¡µä¸­æ‰¾åˆ°æœºå™¨GUID
   - ç‚¹å‡»"ä¿®æ”¹GUID"æŒ‰é’®
   - è¾“å…¥æˆ–ç”Ÿæˆæ–°çš„GUID

4. **ä¸‰çº§ç¡®è®¤**
   - å®Œæˆä¸¥æ ¼çš„ä¸‰çº§ç¡®è®¤æµç¨‹
   - ç¡®è®¤äº†è§£æ‰€æœ‰é£é™©
   - ç¡®è®¤å…·å¤‡æ¢å¤èƒ½åŠ›

5. **é‡å¯ç³»ç»Ÿ**
   - ä¿®æ”¹å®Œæˆåå¿…é¡»é‡å¯ç³»ç»Ÿ
   - æ£€æŸ¥ç³»ç»ŸåŠŸèƒ½æ˜¯å¦æ­£å¸¸
   - éªŒè¯ç›¸å…³è½¯ä»¶æ˜¯å¦æ­£å¸¸è¿è¡Œ

### å¯èƒ½çš„é£é™©

ğŸš¨ **ä¸¥é‡é£é™©**ï¼š
- è½¯ä»¶è®¸å¯è¯å¯èƒ½å¤±æ•ˆ
- Windowsæ¿€æ´»çŠ¶æ€å¯èƒ½å—å½±å“
- æŸäº›åº”ç”¨ç¨‹åºå¯èƒ½æ— æ³•è¿è¡Œ
- ç³»ç»Ÿç¨³å®šæ€§å¯èƒ½å—å½±å“

### æ¢å¤æ–¹æ¡ˆ

å¦‚æœå‡ºç°é—®é¢˜ï¼š
1. ä»å¤‡ä»½æ¢å¤æ³¨å†Œè¡¨
2. æ¢å¤åŸå§‹GUIDå€¼
3. é‡æ–°æ¿€æ´»Windows
4. é‡æ–°å®‰è£…å—å½±å“çš„è½¯ä»¶
5. ä½¿ç”¨ç³»ç»Ÿè¿˜åŸåŠŸèƒ½

### æ³•å¾‹å’Œä¼¦ç†

âš ï¸ **é‡è¦æé†’**ï¼š
- ä»…åœ¨æˆæƒçš„ç³»ç»Ÿä¸Šä½¿ç”¨
- ä¸å¾—ç”¨äºç»•è¿‡è½¯ä»¶è®¸å¯è¯é™åˆ¶
- éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„
- æ‰¿æ‹…æ‰€æœ‰ä½¿ç”¨é£é™©
            """,
            
            "å¤‡ä»½ä¸æ¢å¤": """
# å¤‡ä»½ä¸æ¢å¤æŒ‡å—

## å¤‡ä»½çš„é‡è¦æ€§

åœ¨è¿›è¡Œä»»ä½•ç³»ç»Ÿä¿®æ”¹å‰ï¼Œåˆ›å»ºå¤‡ä»½æ˜¯è‡³å…³é‡è¦çš„å®‰å…¨æªæ–½ã€‚

### å¤‡ä»½ç±»å‹

1. **å®Œæ•´å¤‡ä»½**
   - å¤‡ä»½æ‰€æœ‰ç›¸å…³ç³»ç»Ÿè®¾ç½®
   - åŒ…æ‹¬æ³¨å†Œè¡¨ã€ç½‘ç»œé…ç½®ç­‰
   - æ¢å¤æ—¶é—´è¾ƒé•¿ä½†æœ€å®‰å…¨

2. **å¢é‡å¤‡ä»½**
   - åªå¤‡ä»½è‡ªä¸Šæ¬¡å¤‡ä»½åçš„å˜åŒ–
   - å¤‡ä»½é€Ÿåº¦å¿«ï¼Œå ç”¨ç©ºé—´å°
   - éœ€è¦å®Œæ•´å¤‡ä»½ä½œä¸ºåŸºç¡€

3. **å·®å¼‚å¤‡ä»½**
   - å¤‡ä»½è‡ªä¸Šæ¬¡å®Œæ•´å¤‡ä»½åçš„æ‰€æœ‰å˜åŒ–
   - æ¢å¤é€Ÿåº¦æ¯”å¢é‡å¤‡ä»½å¿«
   - å ç”¨ç©ºé—´é€‚ä¸­

### åˆ›å»ºå¤‡ä»½

1. **é€‰æ‹©å¤‡ä»½ç±»å‹**
   - åœ¨"å¤‡ä»½ç®¡ç†"æ ‡ç­¾é¡µä¸­é€‰æ‹©å¤‡ä»½ç±»å‹
   - æ¨èé¦–æ¬¡ä½¿ç”¨å®Œæ•´å¤‡ä»½

2. **é…ç½®å¤‡ä»½é€‰é¡¹**
   - é€‰æ‹©å¤‡ä»½å­˜å‚¨ä½ç½®
   - è®¾ç½®å‹ç¼©å’ŒåŠ å¯†é€‰é¡¹
   - é…ç½®å¤‡ä»½æ–‡ä»¶å‘½åè§„åˆ™

3. **æ‰§è¡Œå¤‡ä»½**
   - ç‚¹å‡»"åˆ›å»ºå¤‡ä»½"æŒ‰é’®
   - ç­‰å¾…å¤‡ä»½è¿‡ç¨‹å®Œæˆ
   - éªŒè¯å¤‡ä»½æ–‡ä»¶å®Œæ•´æ€§

### æ¢å¤ç³»ç»Ÿ

1. **é€‰æ‹©æ¢å¤ç‚¹**
   - åœ¨å¤‡ä»½å†å²ä¸­é€‰æ‹©åˆé€‚çš„å¤‡ä»½
   - æŸ¥çœ‹å¤‡ä»½è¯¦ç»†ä¿¡æ¯
   - ç¡®è®¤å¤‡ä»½æ–‡ä»¶å®Œæ•´æ€§

2. **æ‰§è¡Œæ¢å¤**
   - ç‚¹å‡»"æ¢å¤"æŒ‰é’®
   - ç¡®è®¤æ¢å¤æ“ä½œ
   - ç­‰å¾…æ¢å¤è¿‡ç¨‹å®Œæˆ

3. **éªŒè¯æ¢å¤ç»“æœ**
   - æ£€æŸ¥ç³»ç»ŸåŠŸèƒ½æ˜¯å¦æ­£å¸¸
   - éªŒè¯ç½‘ç»œè¿æ¥
   - æµ‹è¯•ç›¸å…³åº”ç”¨ç¨‹åº

### æœ€ä½³å®è·µ

âœ… **å»ºè®®**ï¼š
- å®šæœŸåˆ›å»ºå¤‡ä»½ï¼ˆå»ºè®®æ¯å‘¨ä¸€æ¬¡ï¼‰
- ä¿ç•™å¤šä¸ªå¤‡ä»½ç‰ˆæœ¬
- å°†å¤‡ä»½å­˜å‚¨åœ¨å®‰å…¨ä½ç½®
- å®šæœŸæµ‹è¯•å¤‡ä»½çš„å¯ç”¨æ€§
- è®°å½•å¤‡ä»½å’Œæ¢å¤æ“ä½œ

### æ•…éšœæ’é™¤

å¦‚æœå¤‡ä»½æˆ–æ¢å¤å¤±è´¥ï¼š
1. æ£€æŸ¥ç£ç›˜ç©ºé—´æ˜¯å¦å……è¶³
2. ç¡®è®¤å…·æœ‰è¶³å¤Ÿçš„ç³»ç»Ÿæƒé™
3. æ£€æŸ¥å¤‡ä»½æ–‡ä»¶æ˜¯å¦æŸå
4. å°è¯•ä½¿ç”¨ç³»ç»Ÿè¿˜åŸåŠŸèƒ½
5. è”ç³»æŠ€æœ¯æ”¯æŒè·å–å¸®åŠ©
            """,
            
            "å¸¸è§é—®é¢˜": """
# å¸¸è§é—®é¢˜è§£ç­”

## ä¸€èˆ¬é—®é¢˜

### Q: ç¨‹åºéœ€è¦ç®¡ç†å‘˜æƒé™å—ï¼Ÿ
A: æ˜¯çš„ï¼Œå¤§éƒ¨åˆ†åŠŸèƒ½éœ€è¦ç®¡ç†å‘˜æƒé™æ‰èƒ½æ­£å¸¸å·¥ä½œã€‚è¯·ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œç¨‹åºã€‚

### Q: ç¨‹åºæ”¯æŒå“ªäº›æ“ä½œç³»ç»Ÿï¼Ÿ
A: ç›®å‰æ”¯æŒWindows 10å’ŒWindows 11ã€‚macOSæ”¯æŒæ­£åœ¨å¼€å‘ä¸­ã€‚

### Q: å¦‚ä½•ç¡®ä¿æ“ä½œå®‰å…¨ï¼Ÿ
A: 
- åœ¨æ“ä½œå‰åˆ›å»ºå®Œæ•´çš„ç³»ç»Ÿå¤‡ä»½
- ä»”ç»†é˜…è¯»é£é™©è­¦å‘Š
- åœ¨æµ‹è¯•ç¯å¢ƒä¸­å…ˆè¿›è¡ŒéªŒè¯
- ç¡®ä¿äº†è§£æ¢å¤æ–¹æ¡ˆ

## MACåœ°å€ç›¸å…³

### Q: ä¸ºä»€ä¹ˆMACåœ°å€ä¿®æ”¹å¤±è´¥ï¼Ÿ
A: å¯èƒ½çš„åŸå› ï¼š
- ç½‘å¡ä¸æ”¯æŒMACåœ°å€ä¿®æ”¹
- æƒé™ä¸è¶³
- ç½‘å¡é©±åŠ¨é—®é¢˜
- MACåœ°å€æ ¼å¼ä¸æ­£ç¡®

### Q: ä¿®æ”¹MACåœ°å€åç½‘ç»œæ— æ³•è¿æ¥ï¼Ÿ
A: è§£å†³æ–¹æ¡ˆï¼š
- é‡å¯ç½‘ç»œé€‚é…å™¨
- æ£€æŸ¥ç½‘ç»œé…ç½®
- æ¢å¤åŸå§‹MACåœ°å€
- é‡æ–°é…ç½®ç½‘ç»œè¿æ¥

### Q: å¦‚ä½•ç”Ÿæˆæœ‰æ•ˆçš„MACåœ°å€ï¼Ÿ
A: 
- ä½¿ç”¨ç¨‹åºå†…ç½®çš„éšæœºç”ŸæˆåŠŸèƒ½
- ç¡®ä¿ç¬¬ä¸€ä¸ªå­—èŠ‚çš„æœ€ä½ä½ä¸º0ï¼ˆå•æ’­åœ°å€ï¼‰
- è®¾ç½®æœ¬åœ°ç®¡ç†ä½ï¼ˆç¬¬ä¸€ä¸ªå­—èŠ‚çš„ç¬¬äºŒä½ä¸º1ï¼‰

## GUIDç›¸å…³

### Q: ä¿®æ”¹GUIDåè½¯ä»¶æ— æ³•æ¿€æ´»ï¼Ÿ
A: è¿™æ˜¯æ­£å¸¸ç°è±¡ï¼Œå› ä¸ºï¼š
- è½¯ä»¶è®¸å¯è¯ä¸æœºå™¨GUIDç»‘å®š
- éœ€è¦é‡æ–°æ¿€æ´»æˆ–é‡æ–°å®‰è£…è½¯ä»¶
- å»ºè®®ä»å¤‡ä»½æ¢å¤åŸå§‹GUID

### Q: å¦‚ä½•æ¢å¤åŸå§‹GUIDï¼Ÿ
A: 
- ä»æ³¨å†Œè¡¨å¤‡ä»½æ¢å¤
- ä½¿ç”¨ç³»ç»Ÿè¿˜åŸåŠŸèƒ½
- æ‰‹åŠ¨ä¿®æ”¹æ³¨å†Œè¡¨é”®å€¼
- é‡æ–°å®‰è£…æ“ä½œç³»ç»Ÿï¼ˆæœ€åæ‰‹æ®µï¼‰

## å¤‡ä»½ç›¸å…³

### Q: å¤‡ä»½æ–‡ä»¶å­˜å‚¨åœ¨å“ªé‡Œï¼Ÿ
A: é»˜è®¤å­˜å‚¨åœ¨ç¨‹åºç›®å½•çš„backupsæ–‡ä»¶å¤¹ä¸­ï¼Œå¯ä»¥åœ¨è®¾ç½®ä¸­ä¿®æ”¹ã€‚

### Q: å¤‡ä»½æ–‡ä»¶å¯ä»¥åœ¨å…¶ä»–ç”µè„‘ä¸Šä½¿ç”¨å—ï¼Ÿ
A: ä¸å»ºè®®ï¼Œå› ä¸ºï¼š
- ç¡¬ä»¶é…ç½®ä¸åŒ
- ç³»ç»Ÿç¯å¢ƒå·®å¼‚
- å¯èƒ½å¯¼è‡´ç³»ç»Ÿä¸ç¨³å®š

### Q: å¦‚ä½•éªŒè¯å¤‡ä»½æ–‡ä»¶çš„å®Œæ•´æ€§ï¼Ÿ
A: 
- æŸ¥çœ‹å¤‡ä»½æ–‡ä»¶å¤§å°
- æ£€æŸ¥å¤‡ä»½æ—¥å¿—
- å°è¯•éƒ¨åˆ†æ¢å¤æµ‹è¯•
- ä½¿ç”¨æ–‡ä»¶æ ¡éªŒå·¥å…·

## æŠ€æœ¯æ”¯æŒ

### Q: é‡åˆ°é—®é¢˜å¦‚ä½•è·å–å¸®åŠ©ï¼Ÿ
A: 
- æŸ¥çœ‹ç¨‹åºæ—¥å¿—æ–‡ä»¶
- å‚è€ƒæœ¬å¸®åŠ©ç³»ç»Ÿ
- æŸ¥çœ‹æ•™è‚²åŠŸèƒ½ä¸­çš„æŒ‡å¯¼
- åœ¨æµ‹è¯•ç¯å¢ƒä¸­é‡ç°é—®é¢˜

### Q: å¦‚ä½•æŠ¥å‘Šç¨‹åºé”™è¯¯ï¼Ÿ
A: 
- è®°å½•è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
- ä¿å­˜ç›¸å…³æ—¥å¿—æ–‡ä»¶
- æè¿°æ“ä½œæ­¥éª¤
- æä¾›ç³»ç»Ÿç¯å¢ƒä¿¡æ¯

### Q: ç¨‹åºæ›´æ–°é¢‘ç‡å¦‚ä½•ï¼Ÿ
A:
- å®šæœŸå‘å¸ƒåŠŸèƒ½æ›´æ–°
- åŠæ—¶ä¿®å¤å‘ç°çš„é—®é¢˜
- æ ¹æ®ç”¨æˆ·åé¦ˆæ”¹è¿›åŠŸèƒ½
- ä¿æŒä¸æœ€æ–°ç³»ç»Ÿçš„å…¼å®¹æ€§
            """,

            "å­¦ä¹ èµ„æº": """
# å­¦ä¹ èµ„æº

## æŠ€æœ¯æ–‡æ¡£

### è®¾å¤‡æŒ‡çº¹è¯†åˆ«æŠ€æœ¯
- **MACåœ°å€åŸç†**ï¼šäº†è§£MACåœ°å€çš„ç»“æ„å’Œä½œç”¨æœºåˆ¶
- **GUIDç³»ç»Ÿ**ï¼šWindowsæœºå™¨GUIDçš„ç”Ÿæˆå’Œç®¡ç†åŸç†
- **ç½‘ç»œåè®®**ï¼šä»¥å¤ªç½‘åè®®å’Œç½‘ç»œæ ‡è¯†ç¬¦çš„å·¥ä½œåŸç†
- **æ³¨å†Œè¡¨ç»“æ„**ï¼šWindowsæ³¨å†Œè¡¨ä¸­ç½‘ç»œé…ç½®çš„å­˜å‚¨æ–¹å¼

### ç½‘ç»œå®‰å…¨åŸºç¡€
- **ç½‘ç»œèº«ä»½è¯†åˆ«**ï¼šè®¾å¤‡åœ¨ç½‘ç»œä¸­çš„èº«ä»½è¯†åˆ«æœºåˆ¶
- **MACåœ°å€æ¬ºéª—**ï¼šMACåœ°å€ä¿®æ”¹çš„æŠ€æœ¯åŸç†å’Œåº”ç”¨åœºæ™¯
- **ç½‘ç»œè¿½è¸ªæŠ€æœ¯**ï¼šåŸºäºè®¾å¤‡æŒ‡çº¹çš„ç½‘ç»œè¿½è¸ªæ–¹æ³•
- **éšç§ä¿æŠ¤**ï¼šè®¾å¤‡æŒ‡çº¹ä¸ç”¨æˆ·éšç§ä¿æŠ¤çš„å…³ç³»

## å®è·µæŒ‡å¯¼

### å®éªŒç¯å¢ƒæ­å»º
1. **è™šæ‹Ÿæœºç¯å¢ƒ**
   - ä½¿ç”¨VMwareæˆ–VirtualBoxåˆ›å»ºæµ‹è¯•ç¯å¢ƒ
   - é…ç½®ç½‘ç»œé€‚é…å™¨å’Œè™šæ‹Ÿç½‘ç»œ
   - åˆ›å»ºç³»ç»Ÿå¿«ç…§ä¾¿äºæ¢å¤

2. **ç½‘ç»œç¯å¢ƒé…ç½®**
   - æ­å»ºéš”ç¦»çš„æµ‹è¯•ç½‘ç»œ
   - é…ç½®DHCPæœåŠ¡å™¨
   - è®¾ç½®ç½‘ç»œç›‘æ§å·¥å…·

3. **å®‰å…¨æªæ–½**
   - ç¡®ä¿åœ¨æˆæƒç¯å¢ƒä¸­è¿›è¡Œæµ‹è¯•
   - å»ºç«‹å®Œæ•´çš„å¤‡ä»½å’Œæ¢å¤æœºåˆ¶
   - åˆ¶å®šåº”æ€¥å“åº”é¢„æ¡ˆ

### æ“ä½œæ¼”ç»ƒ
1. **åŸºç¡€æ“ä½œ**
   - æŸ¥çœ‹å’Œåˆ†æç½‘ç»œé€‚é…å™¨ä¿¡æ¯
   - ç†è§£MACåœ°å€çš„ç»„æˆå’Œå«ä¹‰
   - å­¦ä¹ æ³¨å†Œè¡¨çš„ç›¸å…³é”®å€¼

2. **è¿›é˜¶æ“ä½œ**
   - å®‰å…¨åœ°ä¿®æ”¹MACåœ°å€
   - ç†è§£ä¿®æ”¹å¯¹ç½‘ç»œè¿æ¥çš„å½±å“
   - æŒæ¡æ¢å¤åŸå§‹è®¾ç½®çš„æ–¹æ³•

3. **é«˜çº§åº”ç”¨**
   - æ‰¹é‡ç®¡ç†å¤šä¸ªç½‘ç»œé€‚é…å™¨
   - è‡ªåŠ¨åŒ–å¤‡ä»½å’Œæ¢å¤æµç¨‹
   - é›†æˆåˆ°ç³»ç»Ÿç®¡ç†è„šæœ¬ä¸­

## å‚è€ƒèµ„æ–™

### æŠ€æœ¯æ ‡å‡†
- **IEEE 802æ ‡å‡†**ï¼šä»¥å¤ªç½‘å’Œæ— çº¿ç½‘ç»œçš„æŠ€æœ¯æ ‡å‡†
- **RFCæ–‡æ¡£**ï¼šç½‘ç»œåè®®çš„å®˜æ–¹è§„èŒƒæ–‡æ¡£
- **Microsoftæ–‡æ¡£**ï¼šWindowsç³»ç»Ÿç½‘ç»œé…ç½®çš„å®˜æ–¹æ–‡æ¡£

### å­¦ä¹ ç½‘ç«™
- **ç½‘ç»œå®‰å…¨æ•™è‚²å¹³å°**ï¼šä¸“ä¸šçš„ç½‘ç»œå®‰å…¨å­¦ä¹ èµ„æº
- **æŠ€æœ¯åšå®¢å’Œè®ºå›**ï¼šå®è·µç»éªŒåˆ†äº«å’Œé—®é¢˜è®¨è®º
- **å¼€æºé¡¹ç›®**ï¼šç›¸å…³å·¥å…·çš„æºä»£ç å’Œæ–‡æ¡£

### ä¹¦ç±æ¨è
- ã€Šç½‘ç»œå®‰å…¨æŠ€æœ¯ä¸å®è·µã€‹
- ã€ŠWindowsç³»ç»Ÿå†…æ ¸åŸç†ã€‹
- ã€Šç½‘ç»œåè®®åˆ†æä¸åº”ç”¨ã€‹
- ã€Šä¿¡æ¯å®‰å…¨ç®¡ç†ä¸å®è·µã€‹

## æ³•å¾‹å’Œä¼¦ç†

### ä½¿ç”¨è§„èŒƒ
âš ï¸ **é‡è¦æé†’**ï¼š
- ä»…åœ¨æˆæƒçš„ç³»ç»Ÿå’Œç½‘ç»œç¯å¢ƒä¸­ä½¿ç”¨
- ä¸å¾—ç”¨äºéæ³•ç½‘ç»œæ´»åŠ¨æˆ–æ”»å‡»è¡Œä¸º
- éµå®ˆå½“åœ°æ³•å¾‹æ³•è§„å’Œç½‘ç»œä½¿ç”¨æ”¿ç­–
- å°Šé‡ä»–äººçš„ç½‘ç»œæƒç›Šå’Œéšç§

### æ•™è‚²ç›®çš„
- æœ¬å·¥å…·ä¸“ä¸ºæ•™å­¦å’Œç ”ç©¶è®¾è®¡
- å¸®åŠ©ç†è§£ç½‘ç»œå®‰å…¨æŠ€æœ¯åŸç†
- æé«˜ç½‘ç»œå®‰å…¨æ„è¯†å’Œé˜²æŠ¤èƒ½åŠ›
- åŸ¹å…»è´Ÿè´£ä»»çš„ç½‘ç»œå®‰å…¨ä¸“ä¸šäººå‘˜

### è´£ä»»å£°æ˜
- ç”¨æˆ·éœ€æ‰¿æ‹…æ‰€æœ‰ä½¿ç”¨é£é™©å’Œè´£ä»»
- å¼€å‘å›¢é˜Ÿä¸æ‰¿æ‹…ä»»ä½•æ»¥ç”¨åæœ
- å»ºè®®åœ¨ä¸“ä¸šæŒ‡å¯¼ä¸‹è¿›è¡Œå­¦ä¹ å’Œå®è·µ
- å¦‚æœ‰ç–‘é—®è¯·å’¨è¯¢ç›¸å…³æ³•å¾‹ä¸“å®¶

## æŠ€æœ¯æ”¯æŒ

### è·å–å¸®åŠ©
- æŸ¥çœ‹ç¨‹åºå†…ç½®çš„å¸®åŠ©æ–‡æ¡£
- å‚è€ƒæ•™è‚²åŠŸèƒ½ä¸­çš„è¯¦ç»†æŒ‡å¯¼
- æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶äº†è§£è¯¦ç»†ä¿¡æ¯
- åœ¨æµ‹è¯•ç¯å¢ƒä¸­éªŒè¯æ“ä½œæ­¥éª¤

### é—®é¢˜åé¦ˆ
- è¯¦ç»†æè¿°é‡åˆ°çš„é—®é¢˜
- æä¾›ç›¸å…³çš„æ—¥å¿—ä¿¡æ¯
- è¯´æ˜æ“ä½œç³»ç»Ÿå’Œç¯å¢ƒä¿¡æ¯
- æè¿°é‡ç°é—®é¢˜çš„å…·ä½“æ­¥éª¤

### æŒç»­å­¦ä¹ 
- å…³æ³¨ç½‘ç»œå®‰å…¨æŠ€æœ¯çš„æœ€æ–°å‘å±•
- å‚ä¸ç›¸å…³çš„å­¦æœ¯ç ”ç©¶å’Œè®¨è®º
- å®è·µä¸­ä¸æ–­æé«˜æŠ€æœ¯æ°´å¹³
- åˆ†äº«ç»éªŒå¸®åŠ©å…¶ä»–å­¦ä¹ è€…
            """
        }

        return help_contents.get(topic, "å¸®åŠ©å†…å®¹æ­£åœ¨å‡†å¤‡ä¸­...")


class QuickHelpWidget(QWidget):
    """å¿«é€Ÿå¸®åŠ©æ§ä»¶"""
    
    def __init__(self):
        super().__init__()
        self.init_ui()
    
    def init_ui(self):
        """åˆå§‹åŒ–ç•Œé¢"""
        layout = QVBoxLayout(self)
        
        # å¿«é€Ÿé“¾æ¥
        quick_links_group = QGroupBox("å¿«é€Ÿé“¾æ¥")
        links_layout = QGridLayout(quick_links_group)
        
        # åˆ›å»ºå¿«é€Ÿé“¾æ¥æŒ‰é’®
        quick_links = [
            ("ğŸš€ å¿«é€Ÿå…¥é—¨", "å¿«é€Ÿå…¥é—¨"),
            ("ğŸ”§ MACåœ°å€ä¿®æ”¹", "MACåœ°å€ä¿®æ”¹"),
            ("ğŸ†” æœºå™¨GUIDä¿®æ”¹", "æœºå™¨GUIDä¿®æ”¹"),
            ("ğŸ’¾ å¤‡ä»½ä¸æ¢å¤", "å¤‡ä»½ä¸æ¢å¤"),
            ("â“ å¸¸è§é—®é¢˜", "å¸¸è§é—®é¢˜"),
            ("ğŸ“š å­¦ä¹ èµ„æº", "å­¦ä¹ èµ„æº")
        ]
        
        for i, (text, topic) in enumerate(quick_links):
            btn = QPushButton(text)
            btn.clicked.connect(lambda checked, t=topic: self.open_help_topic(t))
            btn.setMinimumHeight(40)
            links_layout.addWidget(btn, i // 2, i % 2)
        
        layout.addWidget(quick_links_group)
        
        # æœ€è¿‘æŸ¥çœ‹
        recent_group = QGroupBox("æœ€è¿‘æŸ¥çœ‹")
        recent_layout = QVBoxLayout(recent_group)
        
        self.recent_list = QListWidget()
        self.recent_list.setMaximumHeight(100)
        self.recent_list.itemDoubleClicked.connect(self.open_recent_topic)
        recent_layout.addWidget(self.recent_list)
        
        layout.addWidget(recent_group)
        
        # æœç´¢åŠŸèƒ½
        search_group = QGroupBox("æœç´¢å¸®åŠ©")
        search_layout = QVBoxLayout(search_group)
        
        search_info = QLabel("ä½¿ç”¨æ•™è‚²åŠŸèƒ½ä¸­çš„å­¦ä¹ èµ„æºè¿›è¡Œè¯¦ç»†æœç´¢")
        search_info.setStyleSheet("color: #666; font-style: italic;")
        search_layout.addWidget(search_info)
        
        layout.addWidget(search_group)
        
        layout.addStretch()
    
    def open_help_topic(self, topic: str):
        """æ‰“å¼€å¸®åŠ©ä¸»é¢˜"""
        # æ·»åŠ åˆ°æœ€è¿‘æŸ¥çœ‹
        self.add_to_recent(topic)

        # æŸ¥æ‰¾å¸®åŠ©ç³»ç»Ÿå¯¹è¯æ¡†å¹¶æ˜¾ç¤ºä¸»é¢˜
        parent = self.parent()
        while parent and not isinstance(parent, HelpSystemDialog):
            parent = parent.parent()

        if parent and isinstance(parent, HelpSystemDialog):
            parent.show_help_topic(topic)
        else:
            # å¦‚æœæ‰¾ä¸åˆ°çˆ¶å¯¹è¯æ¡†ï¼Œå°è¯•ç›´æ¥è®¿é—®å†…å®¹æ§ä»¶
            try:
                # æŸ¥æ‰¾åŒçº§çš„å†…å®¹æ§ä»¶
                dialog = self.window()
                if hasattr(dialog, 'content_widget'):
                    dialog.content_widget.show_help_topic(topic)
            except Exception as e:
                print(f"æ— æ³•æ˜¾ç¤ºå¸®åŠ©ä¸»é¢˜ {topic}: {e}")
    
    def open_recent_topic(self, item: QListWidgetItem):
        """æ‰“å¼€æœ€è¿‘æŸ¥çœ‹çš„ä¸»é¢˜"""
        topic = item.text()
        self.open_help_topic(topic)
    
    def add_to_recent(self, topic: str):
        """æ·»åŠ åˆ°æœ€è¿‘æŸ¥çœ‹"""
        # æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨
        for i in range(self.recent_list.count()):
            if self.recent_list.item(i).text() == topic:
                self.recent_list.takeItem(i)
                break
        
        # æ·»åŠ åˆ°é¡¶éƒ¨
        self.recent_list.insertItem(0, topic)
        
        # é™åˆ¶æœ€å¤§æ•°é‡
        while self.recent_list.count() > 5:
            self.recent_list.takeItem(self.recent_list.count() - 1)


class HelpContentWidget(QWidget):
    """å¸®åŠ©å†…å®¹æ˜¾ç¤ºæ§ä»¶"""
    
    def __init__(self):
        super().__init__()
        self.current_topic = None
        self.content_loader = None
        self.init_ui()
    
    def init_ui(self):
        """åˆå§‹åŒ–ç•Œé¢"""
        layout = QVBoxLayout(self)
        
        # æ ‡é¢˜æ 
        title_layout = QHBoxLayout()
        
        self.title_label = QLabel("é€‰æ‹©å¸®åŠ©ä¸»é¢˜")
        self.title_label.setFont(QFont("Microsoft YaHei UI", 14, QFont.Bold))
        title_layout.addWidget(self.title_label)
        
        title_layout.addStretch()
        
        # æ‰“å°æŒ‰é’®
        print_btn = QPushButton("æ‰“å°")
        print_btn.clicked.connect(self.print_content)
        title_layout.addWidget(print_btn)
        
        layout.addLayout(title_layout)
        
        # è¿›åº¦æ¡
        self.progress_bar = QProgressBar()
        self.progress_bar.setVisible(False)
        layout.addWidget(self.progress_bar)
        
        # å†…å®¹æ˜¾ç¤º
        self.content_text = QTextEdit()
        self.content_text.setReadOnly(True)
        self.content_text.setFont(QFont("Microsoft YaHei UI", 10))
        layout.addWidget(self.content_text)
        
        # æ˜¾ç¤ºæ¬¢è¿ä¿¡æ¯
        self.show_welcome_message()
    
    def show_welcome_message(self):
        """æ˜¾ç¤ºæ¬¢è¿ä¿¡æ¯"""
        welcome_text = """
# æ¬¢è¿ä½¿ç”¨å¸®åŠ©ç³»ç»Ÿ

## å¦‚ä½•ä½¿ç”¨å¸®åŠ©ç³»ç»Ÿ

1. **å¿«é€Ÿé“¾æ¥**ï¼šç‚¹å‡»å·¦ä¾§çš„å¿«é€Ÿé“¾æ¥æŒ‰é’®å¿«é€Ÿè®¿é—®å¸¸ç”¨å¸®åŠ©ä¸»é¢˜
2. **æœ€è¿‘æŸ¥çœ‹**ï¼šæŸ¥çœ‹æœ€è¿‘è®¿é—®è¿‡çš„å¸®åŠ©ä¸»é¢˜
3. **è¯¦ç»†å†…å®¹**ï¼šæ¯ä¸ªä¸»é¢˜éƒ½æä¾›è¯¦ç»†çš„è¯´æ˜å’Œæ“ä½œæŒ‡å¯¼

## è·å–æ›´å¤šå¸®åŠ©

- æŸ¥çœ‹"æ•™è‚²åŠŸèƒ½"æ ‡ç­¾é¡µä¸­çš„è¯¦ç»†å­¦ä¹ èµ„æº
- å‚è€ƒæ“ä½œæŒ‡å¯¼äº†è§£å…·ä½“æ­¥éª¤
- æŸ¥çœ‹ç¨‹åºæ—¥å¿—äº†è§£è¯¦ç»†ä¿¡æ¯

## å®‰å…¨æé†’

âš ï¸ è¯·å§‹ç»ˆè®°ä½ï¼š
- æœ¬å·¥å…·ä»…ç”¨äºæ•™å­¦å’Œç ”ç©¶ç›®çš„
- åœ¨è¿›è¡Œä»»ä½•ä¿®æ”¹å‰è¯·åˆ›å»ºå¤‡ä»½
- ä»”ç»†é˜…è¯»é£é™©è­¦å‘Šå’Œæ“ä½œè¯´æ˜
- éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„

é€‰æ‹©å·¦ä¾§çš„å¸®åŠ©ä¸»é¢˜å¼€å§‹å­¦ä¹ ï¼
        """
        
        self.content_text.setMarkdown(welcome_text)
    
    def show_help_topic(self, topic: str):
        """æ˜¾ç¤ºå¸®åŠ©ä¸»é¢˜"""
        if self.content_loader and self.content_loader.isRunning():
            self.content_loader.terminate()
            self.content_loader.wait()
        
        self.current_topic = topic
        self.title_label.setText(f"å¸®åŠ©ä¸»é¢˜: {topic}")
        
        # æ˜¾ç¤ºåŠ è½½è¿›åº¦
        self.progress_bar.setVisible(True)
        self.progress_bar.setValue(0)
        
        # å¯åŠ¨å†…å®¹åŠ è½½å™¨
        self.content_loader = HelpContentLoader(topic)
        self.content_loader.content_loaded.connect(self.on_content_loaded)
        self.content_loader.loading_progress.connect(self.on_loading_progress)
        self.content_loader.start()
    
    def on_content_loaded(self, topic: str, content: str):
        """å†…å®¹åŠ è½½å®Œæˆ"""
        if topic == self.current_topic:
            self.content_text.setMarkdown(content)
        
        self.progress_bar.setVisible(False)
        
        if self.content_loader:
            self.content_loader.deleteLater()
            self.content_loader = None
    
    def on_loading_progress(self, value: int, message: str):
        """åŠ è½½è¿›åº¦æ›´æ–°"""
        self.progress_bar.setValue(value)
    
    def print_content(self):
        """æ‰“å°å†…å®¹"""
        if self.current_topic:
            try:
                # å°è¯•å¯¼å…¥æ‰“å°æ”¯æŒ
                from PyQt5.QtPrintSupport import QPrintDialog, QPrinter

                printer = QPrinter()
                dialog = QPrintDialog(printer, self)

                if dialog.exec_() == QPrintDialog.Accepted:
                    self.content_text.print_(printer)
            except ImportError:
                # å¦‚æœæ²¡æœ‰æ‰“å°æ”¯æŒï¼Œæ˜¾ç¤ºæç¤ºä¿¡æ¯
                from PyQt5.QtWidgets import QMessageBox
                QMessageBox.information(self, "æ‰“å°åŠŸèƒ½",
                                      "æ‰“å°åŠŸèƒ½éœ€è¦PyQt5æ‰“å°æ”¯æŒæ¨¡å—ã€‚\n"
                                      "æ‚¨å¯ä»¥å¤åˆ¶å†…å®¹åˆ°å…¶ä»–åº”ç”¨ç¨‹åºè¿›è¡Œæ‰“å°ã€‚")
            except Exception as e:
                from PyQt5.QtWidgets import QMessageBox
                QMessageBox.warning(self, "æ‰“å°é”™è¯¯", f"æ‰“å°å¤±è´¥: {e}")


class HelpSystemDialog(QDialog):
    """å¸®åŠ©ç³»ç»Ÿå¯¹è¯æ¡†"""
    
    def __init__(self, parent=None):
        super().__init__(parent)
        self.logger = get_logger("help_system")
        self.init_ui()
    
    def init_ui(self):
        """åˆå§‹åŒ–ç•Œé¢"""
        self.setWindowTitle("å¸®åŠ©ç³»ç»Ÿ")
        self.setFixedSize(900, 700)
        self.setModal(False)  # å…è®¸ä¸ä¸»çª—å£åŒæ—¶æ“ä½œ
        
        layout = QVBoxLayout(self)
        
        # åˆ›å»ºåˆ†å‰²å™¨
        splitter = QSplitter(Qt.Horizontal)
        layout.addWidget(splitter)
        
        # å·¦ä¾§ï¼šå¿«é€Ÿå¸®åŠ©
        self.quick_help_widget = QuickHelpWidget()
        self.quick_help_widget.setMaximumWidth(250)
        splitter.addWidget(self.quick_help_widget)
        
        # å³ä¾§ï¼šå¸®åŠ©å†…å®¹
        self.content_widget = HelpContentWidget()
        splitter.addWidget(self.content_widget)
        
        # è®¾ç½®åˆ†å‰²å™¨æ¯”ä¾‹
        splitter.setSizes([250, 650])
        
        # æŒ‰é’®åŒºåŸŸ
        button_box = QDialogButtonBox()
        close_btn = QPushButton("å…³é—­")
        close_btn.clicked.connect(self.close)
        button_box.addButton(close_btn, QDialogButtonBox.RejectRole)
        
        layout.addWidget(button_box)
        
        # åº”ç”¨æ ·å¼
        self.apply_styles()
    
    def apply_styles(self):
        """åº”ç”¨æ ·å¼"""
        self.setStyleSheet("""
            QGroupBox {
                font-weight: bold;
                border: 2px solid #cccccc;
                border-radius: 5px;
                margin-top: 10px;
                padding-top: 10px;
            }
            QGroupBox::title {
                subcontrol-origin: margin;
                left: 10px;
                padding: 0 5px 0 5px;
            }
            QPushButton {
                padding: 8px 16px;
                border: 1px solid #cccccc;
                border-radius: 3px;
                background-color: #f8f8f8;
                text-align: left;
            }
            QPushButton:hover {
                background-color: #e8e8e8;
            }
            QPushButton:pressed {
                background-color: #d8d8d8;
            }
        """)
    
    def show_help_topic(self, topic: str):
        """æ˜¾ç¤ºå¸®åŠ©ä¸»é¢˜"""
        self.content_widget.show_help_topic(topic)
    
    def closeEvent(self, event):
        """å…³é—­äº‹ä»¶"""
        self.logger.info("å¸®åŠ©ç³»ç»Ÿå…³é—­")
        event.accept()
